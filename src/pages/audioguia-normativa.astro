---
import Layout from '../components/ui/Layout.astro';
import Header from '../components/ui/Header.astro';
import Footer from '../components/ui/Footer.astro';
import AudioguideContainer from '../components/react/AudioguideContainer.jsx';
import RoutesSection from '../components/ui/RoutesSection.astro';

// Importar datos
import muralsData from '../data/murals.json';
import contentEs from '../data/content-es.json';

// Configuración de la página
const lang = 'es';
const audioType = 'normal';
const { murals, route } = muralsData;
const content = contentEs;

// SEO y metadatos
const pageTitle = `${content.audioguidePages.normal.title} ${content.seo.pageTitles.suffix}`;
const pageDescription = content.audioguidePages.normal.description;
---

<Layout 
  title={pageTitle}
  description={pageDescription}
  lang={lang}
>
  <Header lang={lang} />
  
  <main class="min-h-screen bg-slate-50 dark:bg-slate-900">
    <!-- Skip link -->
    <a href="#main-content" class="skip-link">
      {content.accessibility.skipToContent}
    </a>

    <!-- Hero section simplificado y directo -->
    <section class="bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700">
      <div class="container mx-auto px-4 py-6">
        <div class="max-w-4xl mx-auto text-center">

          <!-- Título directo -->
          <h1 class="text-fluid-xl font-bold mb-6 text-slate-900 dark:text-slate-100">
            {content.audioguidePages.normal.emoji} {content.audioguidePages.normal.title}
          </h1>

          <!-- Botón principal súper prominente -->
          <div class="mb-8">
            <button
              id="start-tour-button"
              onclick="window.startAudioguide && window.startAudioguide()"
              disabled
              class="group relative bg-gradient-to-r from-SM-blue to-blue-700 hover:from-blue-700 hover:to-SM-blue text-white font-bold text-xl px-12 py-6 rounded-2xl shadow-2xl transition-all duration-300 hover:shadow-3xl hover:scale-110 focus:outline-none focus:ring-4 focus:ring-SM-blue/50 transform hover:-translate-y-1 opacity-50 cursor-not-allowed disabled:hover:scale-100 disabled:hover:shadow-2xl"
            >
              <span class="flex items-center justify-center space-x-3">
                <span class="button-text" data-original-text={content.audioguidePages.normal.startButton}>Cargando...</span>
                <span class="text-2xl group-hover:animate-bounce">▶️</span>
              </span>

              <!-- Efecto de brillo -->
              <div class="absolute inset-0 rounded-2xl bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 transform -skew-x-12"></div>
            </button>

            <!-- Texto de ayuda sutil -->
            <p class="text-sm text-slate-500 dark:text-slate-400 mt-3">
              {content.audioguidePages.normal.clickToStart}
            </p>
            <br>
            <p class="text-sm text-slate-500 dark:text-slate-400 mt-3">
            {content.audioguidePages.normal.downloadBrochure1}<br>
            <a href="/brochure/spanish.pdf" target="_blank" rel="noopener noreferrer" class="inline-block mt-2 px-4 py-2 bg-SM-yellow !text-black font-semibold rounded-lg hover:bg-yellow-500 transition-colors duration-200">
              📥 Descargar folleto
            </a><br>
            {content.audioguidePages.normal.downloadBrochure2}
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Contenido principal -->
    <div id="main-content" class="container mx-auto px-4 py-8">
      <div class="max-w-6xl mx-auto">

        <!-- Componente contenedor con toda la funcionalidad -->
        <AudioguideContainer
          muralsData={murals}
          routeData={route}
          audioType={audioType}
          language={lang}
          client:load
        />
        
        <!-- Sección de rutas -->
        <div class="mt-8">
          <RoutesSection language={lang} />
        </div>
      </div>
    </div>
  </main>

  <Footer lang={lang} />

  <!-- Script para funcionalidad básica -->
  <script>
    // El componente AudioguideContainer maneja toda la funcionalidad
    // Solo necesitamos asegurar que el botón de inicio funcione
    document.addEventListener('DOMContentLoaded', () => {
      // El botón ya tiene onclick="window.startAudioguide && window.startAudioguide()"
      // La función startAudioguide se expone desde AudioguideContainer
    });
  </script>
</Layout>
